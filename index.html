<!DOCTYPE html>
<html lang="vi">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>MCPExNghia Addons - Neon Final (Search & Ratings)</title>
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Orbitron:wght@600&display=swap');
    :root{
      --violet:#8a3cff;
      --violet-2:#5bd0ff; /* cyan accent */
      --bg:#050006;
      --card:#110018;
      --glass: rgba(20,8,30,0.6);
    }
    html,body{height:100%;margin:0;background:
      radial-gradient(circle at 10% 10%, rgba(20,6,40,0.6), transparent 15%),
      radial-gradient(circle at 90% 90%, rgba(0,20,40,0.25), transparent 15%),
      var(--bg);
      color:#e8eef8;
      font-family: 'Orbitron', sans-serif;
      -webkit-font-smoothing:antialiased;
      -moz-osx-font-smoothing:grayscale;
    }
    /* Intro */
    #intro{
      position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
      background:linear-gradient(180deg, rgba(12,2,30,0.98), rgba(0,0,0,0.95));
      z-index:9999;
      animation:introHide 2s forwards;
    }
    #intro h1{
      color:var(--violet);
      font-size:2.6rem;
      margin:0;
      text-shadow:0 0 12px var(--violet),0 0 30px var(--violet-2);
      letter-spacing:1px;
      animation:glow 1.6s ease-in-out infinite alternate;
    }
    #intro p{margin-top:10px;color:rgba(150,200,255,0.9)}
    @keyframes glow{
      from{text-shadow:0 0 8px var(--violet);}
      to{text-shadow:0 0 28px var(--violet-2);}
    }
    @keyframes introHide{
      0%{opacity:1}
      85%{opacity:1}
      100%{opacity:0;visibility:hidden}
    }

    /* Header */
    header{
      position:sticky;top:0;z-index:50;
      display:flex;align-items:center;justify-content:center;padding:12px;background:linear-gradient(90deg, rgba(8,2,20,0.6), rgba(10,4,30,0.6));
      border-bottom:1px solid rgba(120,80,200,0.08);
      box-shadow:0 2px 20px rgba(80,30,140,0.06);
    }
    header h1{margin:0;color:var(--violet);text-shadow:0 0 8px rgba(90,40,180,0.4);}
    .menu-icon{
      position:absolute;left:16px;font-size:1.6rem;color:var(--violet-2);cursor:pointer;user-select:none;
    }
    .menu-icon:hover{transform:scale(1.08)}

    /* Sidebar */
    #sidebar{
      position:fixed;left:-280px;top:0;height:100%;width:280px;
      background:linear-gradient(180deg, rgba(18,6,36,0.98), rgba(6,2,18,0.98));
      box-shadow: 8px 0 40px rgba(90,40,180,0.18);
      border-right:1px solid rgba(120,80,200,0.12);
      transition:left .36s cubic-bezier(.2,.9,.2,1);
      z-index:2000;padding-top:24px;display:flex;flex-direction:column;
    }
    #sidebar.active{left:0}
    #sidebar .close-btn{position:absolute;right:10px;top:10px;background:transparent;border:none;color:var(--violet-2);font-size:1.4rem;cursor:pointer}
    #sidebar nav{display:flex;flex-direction:column;gap:6px;padding:10px 8px}
    #sidebar a{display:flex;gap:10px;align-items:center;padding:12px 14px;border-radius:8px;color:#e8e8ff;text-decoration:none;margin:6px 8px;transition:background .2s}
    #sidebar a:hover{background:linear-gradient(90deg, rgba(120,80,200,0.08), rgba(80,40,180,0.04));}
    #sidebar .icon{font-size:1.2rem;opacity:0.95}
    #sidebar .label{font-size:0.96rem}

    /* Admin Access box at bottom */
    #admin-access{margin-top:auto;padding:12px;border-top:1px solid rgba(120,80,200,0.06)}
    .admin-box{display:flex;flex-direction:column;gap:8px;padding:8px 10px}
    .admin-input{padding:8px;border-radius:8px;border:1px solid rgba(180,140,255,0.12);background:transparent;color:#fff;outline:none}
    .admin-btn{padding:8px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--violet),var(--violet-2));color:#000;font-weight:700;cursor:pointer}

    /* Admin Tools (hidden until admin) */
    #admin-tools{display:none;margin-top:8px;padding:8px 6px}
    .admin-tools .tool{padding:8px 10px;border-radius:8px;margin:6px 8px;background:rgba(120,80,200,0.04);display:flex;justify-content:space-between;gap:8px;align-items:center}
    .admin-tools input{padding:8px;border-radius:6px;border:1px solid rgba(180,140,255,0.08);background:transparent;color:#fff}

    /* Main area */
    main{padding:18px 16px 80px;max-width:1100px;margin:0 auto;}
    .search-row{display:flex;gap:12px;align-items:center;justify-content:center;margin-bottom:12px}
    .search-input{width:100%;max-width:640px;padding:10px 12px;border-radius:10px;border:1px solid rgba(120,80,200,0.08);background:linear-gradient(90deg, rgba(10,4,20,0.6), rgba(15,6,30,0.6));color:#fff;outline:none}
    .search-input:focus{box-shadow:0 0 20px rgba(90,40,180,0.12);border-color:var(--violet-2)}
    #addons-container{display:flex;flex-wrap:wrap;gap:22px;justify-content:center}
    .card{width:300px;background:linear-gradient(180deg, rgba(20,6,40,0.75), rgba(8,2,20,0.6));border-radius:12px;padding:14px;border:1px solid rgba(120,80,200,0.08);box-shadow:0 6px 22px rgba(90,40,180,0.06);transition:transform .28s,box-shadow .28s;cursor: pointer}
    .card:hover{transform:translateY(-6px);box-shadow:0 16px 40px rgba(90,40,180,0.14)}
    .card img{width:100%;height:160px;object-fit:cover;border-radius:8px;box-shadow:0 6px 18px rgba(30,10,80,0.18)}
    .card h3{margin:10px 0 6px;color:var(--violet-2)}
    .card p{margin:0;color:rgba(220,220,255,0.9);font-size:0.95rem;height:44px;overflow:hidden}
    .card .cta{margin-top:10px;display:flex;gap:8px;justify-content:center}
    .btn{padding:8px 12px;border-radius:8px;border:none;background:linear-gradient(90deg,var(--violet),var(--violet-2));color:#000;font-weight:700;cursor:pointer}
    .btn.secondary{background:transparent;border:1px solid rgba(180,140,255,0.08);color:#eaf4ff}

    .rating{display:flex;gap:4px;justify-content:center;margin-top:8px}
    .star{font-size:1.1rem;cursor:pointer;opacity:0.85;filter:drop-shadow(0 0 6px rgba(90,40,180,0.15))}
    .star.fill{color:gold;text-shadow:0 0 8px gold}
    .avg-score{font-size:0.9rem;color:rgba(230,230,255,0.9);margin-left:8px}

    /* Popup */
    #popup{position:fixed;inset:0;display:none;align-items:center;justify-content:center;background:linear-gradient(rgba(0,0,0,0.6),rgba(0,0,0,0.8));z-index:3000;padding:20px}
    .popup-card{width:100%;max-width:680px;background:linear-gradient(180deg, rgba(18,2,36,0.98), rgba(6,2,18,0.98));border-radius:12px;padding:18px;border:1px solid rgba(120,80,200,0.1);box-shadow:0 30px 80px rgba(30,8,60,0.6)}
    .popup-card img{width:100%;height:300px;object-fit:cover;border-radius:8px}
    .popup-meta{display:flex;justify-content:space-between;align-items:center;margin-top:12px;gap:12px}
    .comments{margin-top:12px;padding-top:12px;border-top:1px dashed rgba(120,80,200,0.06)}
    .comment-list{max-height:180px;overflow:auto;margin-top:8px;display:flex;flex-direction:column;gap:8px}
    .comment{background:rgba(255,255,255,0.02);padding:8px;border-radius:8px;border:1px solid rgba(120,80,200,0.04)}
    .comment .meta{font-size:0.8rem;color:rgba(200,200,255,0.7)}
    .comment .body{margin-top:6px;color:#e8eef8}

    /* Footer */
    footer{position:fixed;left:0;right:0;bottom:0;padding:10px;background:linear-gradient(90deg, rgba(6,2,20,0.6), rgba(20,6,40,0.6));border-top:1px solid rgba(120,80,200,0.06);text-align:center;color:rgba(200,200,255,0.9);font-size:0.9rem}

    /* Responsive */
    @media (max-width:720px){
      .card{width:90%}
      #sidebar{width:86%;left:-100%}
      #sidebar.active{left:0}
    }
  </style>
</head>
<body>
  
  <!-- Intro -->
  <div id="intro" aria-hidden="true">
    <h1 id="typewriter"></h1>
    <p id="subline" style="opacity:0;color:rgba(150,200,255,0.9);margin-top:10px;">Neon Deluxe ‚Äî Cold Violet</p>
  </div>

  <script>
    const text = "‚ö° MCPExNghia Addons";
    let idx = 0;
    function typeEffect(){
      const el = document.getElementById('typewriter');
      if(!el) return;
      if(idx < text.length){
        el.textContent = text.slice(0, idx+1);
        idx++;
        setTimeout(typeEffect, 90);
      } else {
        document.getElementById('subline').style.opacity = 1;
        setTimeout(()=>{
          const intro = document.getElementById('intro');
          intro.style.transition='opacity 1.5s ease';
          intro.style.opacity='0';
          setTimeout(()=>intro.style.display='none',1500);
        },1200);
      }
    }
    window.addEventListener('load', ()=>{
      const el = document.getElementById('typewriter');
      el.style.color='var(--violet)';
      el.style.textShadow='0 0 12px var(--violet),0 0 30px var(--violet-2)';
      el.style.fontSize='2.4rem';
      el.style.letterSpacing='1px';
      el.style.borderRight='3px solid var(--violet-2)';
      el.style.paddingRight='6px';
      el.style.animation='blink-caret 0.8s step-end infinite';
      typeEffect();
    });
  </script>
  <style>
    #intro{position:fixed;inset:0;display:flex;flex-direction:column;align-items:center;justify-content:center;
      background:linear-gradient(180deg, rgba(12,2,30,0.98), rgba(0,0,0,0.95));z-index:9999;}
    @keyframes blink-caret{from,to{border-color:transparent}50%{border-color:var(--violet-2);}}
  </style>

  <!-- Header -->
  <header>
    <div class="menu-icon" onclick="toggleSidebar()">‚ò∞</div>
    <h1>‚ö° MCPExNghia Addons</h1>
  </header>

  <!-- Sidebar -->
  <aside id="sidebar" aria-hidden="true">
    <button class="close-btn" onclick="toggleSidebar()">‚úï</button>
    <nav>
      <a href="#"><span class="icon">üè†</span><span class="label">Trang ch·ªß</span></a>
      <a href="#addons-container"><span class="icon">üß©</span><span class="label">Addons</span></a>
      <a href="#"><span class="icon">üìû</span><span class="label">Li√™n h·ªá</span></a>
      <a href="#"><span class="icon">üí°</span><span class="label">Gi·ªõi thi·ªáu</span></a>
    </nav>

    <!-- Admin Tools (hidden until admin) -->
    <div id="admin-tools" class="admin-tools" aria-hidden="true">
      <div style="padding:8px 12px;color:var(--violet-2);font-weight:700">‚öôÔ∏è Admin Tools</div>
      <div class="tool"><div>‚ûï Th√™m Addon</div><button class="btn" onclick="openAddForm()">M·ªü</button></div>
      <div class="tool"><div>üé® Chuy·ªÉn theme</div><select id="themeSelect" onchange="applyTheme(this.value)" style="background:transparent;color:#fff;border-radius:6px;padding:6px;border:1px solid rgba(180,140,255,0.06)">
        <option value="violet">Violet Cold</option>
        <option value="emerald">Emerald</option>
        <option value="red">Crimson</option>
      </select></div>
      <div class="tool"><div>üö™ ƒêƒÉng xu·∫•t</div><button class="btn" onclick="logoutAdmin()">Tho√°t</button></div>
    </div>

    <!-- Admin access box at bottom -->
    <div id="admin-access">
      <div style="padding:8px 12px;color:rgba(220,220,255,0.9);font-weight:700">üîí Admin Access</div>
      <div class="admin-box">
        <input id="adminKeyInput" class="admin-input" placeholder="Nh·∫≠p key admin..." />
        <div style="display:flex;gap:8px">
          <button class="admin-btn" onclick="tryAdmin()">X√°c nh·∫≠n</button>
          <button class="admin-btn" style="background:transparent;color:#e8eef8;border:1px solid rgba(180,140,255,0.06)" onclick="toggleSidebar()">ƒê√≥ng</button>
        </div>
        <div id="admin-msg" style="font-size:0.9rem;color:rgba(200,200,255,0.6)"></div>
      </div>
    </div>
  </aside>

  <!-- Main -->
  <main>
    <div class="search-row">
      <input id="searchInput" class="search-input" placeholder="T√¨m addon theo t√™n ho·∫∑c m√¥ t·∫£..." oninput="applyFilter()" />
    </div>
    <section id="addons-container" aria-live="polite"></section>
  </main>

  <!-- Popup -->
  <div id="popup" role="dialog" aria-modal="true">
    <div class="popup-card">
      <img id="popupImg" src="" alt="Addon image" />
      <div class="popup-meta">
        <div>
          <h2 id="popupName" style="margin:0;color:var(--violet-2)"></h2>
          <p id="popupDesc" style="margin:6px 0;color:rgba(220,220,255,0.9)"></p>
        </div>
        <div style="display:flex;flex-direction:column;gap:8px;align-items:flex-end">
          <a id="popupLink" class="btn" href="#" target="_blank">‚¨áÔ∏è T·∫£i v·ªÅ</a>
          <button class="btn secondary" onclick="closePopup()">ƒê√≥ng</button>
        </div>
      </div>

      <!-- Comments under each addon -->
      <div class="comments">
        <div style="display:flex;gap:8px;flex-wrap:wrap">
          <input id="commentName" placeholder="T√™n (t√πy ch·ªçn)" style="flex:1;padding:8px;border-radius:8px;border:1px solid rgba(120,80,200,0.06);background:transparent;color:#fff" />
          <input id="commentText" placeholder="Vi·∫øt b√¨nh lu·∫≠n..." style="flex:2;padding:8px;border-radius:8px;border:1px solid rgba(120,80,200,0.06);background:transparent;color:#fff" />
          <button class="btn" onclick="addComment()">G·ª≠i</button>
        </div>
        <div class="comment-list" id="commentList"></div>
      </div>
    </div>
  </div>

  <footer>¬© 2025 MCPExNghia | Neon Deluxe ‚Ä¢ Local comments & ratings only</footer>

<script>
  const SECRET_KEY = 'mcpexnghia2025';
  let addons = [];
  let currentPopupIndex = null;
  let isAdmin = false;
  let currentFilter = '';

  function toggleSidebar(){
    document.getElementById('sidebar').classList.toggle('active');
  }

  function openAddForm(){
    const html = `
      <div style="padding:8px">
        <input id="newName" placeholder="T√™n addon" style="width:100%;padding:8px;border-radius:6px;margin-bottom:8px;background:transparent;border:1px solid rgba(180,140,255,0.06);color:#fff" />
        <input id="newDesc" placeholder="M√¥ t·∫£" style="width:100%;padding:8px;border-radius:6px;margin-bottom:8px;background:transparent;border:1px solid rgba(180,140,255,0.06);color:#fff" />
        <input id="newImg" placeholder="URL ·∫£nh" style="width:100%;padding:8px;border-radius:6px;margin-bottom:8px;background:transparent;border:1px solid rgba(180,140,255,0.06);color:#fff" />
        <input id="newLink" placeholder="Link t·∫£i" style="width:100%;padding:8px;border-radius:6px;margin-bottom:8px;background:transparent;border:1px solid rgba(180,140,255,0.06);color:#fff" />
        <div style="display:flex;gap:8px;justify-content:flex-end">
          <button class="btn" onclick="saveNewAddon()">L∆∞u</button>
          <button class="btn secondary" onclick="renderAddons();">H·ªßy</button>
        </div>
      </div>
    `;
    const adminTools = document.getElementById('admin-tools');
    const container = document.createElement('div');
    container.innerHTML = html;
    adminTools.prepend(container);
  }

  function saveNewAddon(){
    const name = document.getElementById('newName').value.trim();
    const desc = document.getElementById('newDesc').value.trim();
    const img = document.getElementById('newImg').value.trim();
    const link = document.getElementById('newLink').value.trim();
    if(!name||!img){ alert('Vui l√≤ng ƒëi·ªÅn √≠t nh·∫•t t√™n v√† URL ·∫£nh'); return; }
    const obj = {name,description:desc||'No description',image:img,download:link||'#'};
    const custom = JSON.parse(localStorage.getItem('addons_custom')||'[]');
    custom.push(obj);
    localStorage.setItem('addons_custom', JSON.stringify(custom));
    loadAddons();
    alert('‚úÖ Addon m·ªõi ƒë√£ ƒë∆∞·ª£c th√™m (l∆∞u local).');
  }

  function tryAdmin(){
    const val = document.getElementById('adminKeyInput').value.trim();
    if(val===SECRET_KEY){
      isAdmin = true;
      document.getElementById('admin-tools').style.display = 'block';
      document.getElementById('admin-msg').innerText = '‚úÖ Admin mode active';
    } else {
      document.getElementById('admin-msg').innerText = '‚ùå Key sai';
    }
  }

  function logoutAdmin(){
    isAdmin = false;
    document.getElementById('admin-tools').style.display = 'none';
    document.getElementById('adminKeyInput').value = '';
    document.getElementById('admin-msg').innerText = 'ƒê√£ ƒëƒÉng xu·∫•t';
  }

  function applyTheme(name){
    if(name==='emerald'){
      document.documentElement.style.setProperty('--violet','#0fb36b');
      document.documentElement.style.setProperty('--violet-2','#74ffd1');
    } else if(name==='red'){
      document.documentElement.style.setProperty('--violet','#ff4b6e');
      document.documentElement.style.setProperty('--violet-2','#ffb86e');
    } else {
      document.documentElement.style.setProperty('--violet','#8a3cff');
      document.documentElement.style.setProperty('--violet-2','#5bd0ff');
    }
  }

  // Search filtering
  function applyFilter(){
    currentFilter = document.getElementById('searchInput').value.trim().toLowerCase();
    renderAddons();
  }

  // Ratings storage helpers
  function ratingsKey(index){ return 'ratings_addon_'+index; }
  function userRatingKey(index){ return 'rating_user_'+index; }

  function getRatings(index){
    const raw = localStorage.getItem(ratingsKey(index));
    if(!raw) return {sum:0,count:0,user:null};
    try{ return JSON.parse(raw);}catch(e){ return {sum:0,count:0,user:null};}
  }
  function saveRatings(index,obj){
    localStorage.setItem(ratingsKey(index), JSON.stringify(obj));
  }
  function getUserRating(index){
    const raw = localStorage.getItem(userRatingKey(index));
    return raw?Number(raw):null;
  }
  function setUserRating(index, val){
    localStorage.setItem(userRatingKey(index), String(val));
  }

  function rateAddon(index, value){
    const r = getRatings(index);
    const prev = getUserRating(index);
    if(prev){
      r.sum = r.sum - prev + value;
    } else {
      r.sum += value;
      r.count += 1;
    }
    setUserRating(index, value);
    saveRatings(index, r);
    renderAddons();
    if(currentPopupIndex===index){
      renderPopupRating(index);
    }
  }

  function renderRatingStars(containerEl, index, small=false){
    const r = getRatings(index);
    const avg = r.count? (r.sum / r.count):0;
    const user = getUserRating(index);
    containerEl.innerHTML = '';
    for(let s=1;s<=5;s++){
      const span = document.createElement('span');
      span.className = 'star' + ((user && s<=user) || (!user && Math.round(avg)>=s) ? ' fill':'');
      span.innerText = '‚òÖ';
      span.title = (user? 'B·∫°n ƒë√£ ƒë√°nh gi√°: '+ (user):('ƒê√°nh gi√° '+s+' sao'));
      span.onclick = (e)=>{ e.stopPropagation(); rateAddon(index,s); };
      containerEl.appendChild(span);
    }
    const avgEl = document.createElement('span');
    avgEl.className='avg-score';
    avgEl.innerText = r.count? (' ' + ( (r.sum/r.count).toFixed(1) + ' ('+ r.count +' l∆∞·ª£t)')) : ' Ch∆∞a c√≥ ƒë√°nh gi√°';
    containerEl.appendChild(avgEl);
  }

  function renderPopupRating(index){
    const ratingContainer = document.getElementById('popupRating');
    if(!ratingContainer){
      const node = document.createElement('div');
      node.id = 'popupRating';
      node.style.marginTop = '8px';
      document.querySelector('.popup-meta div').appendChild(node);
    }
    renderRatingStars(document.getElementById('popupRating'), index);
  }

  function renderAddons(){
    const container = document.getElementById('addons-container');
    container.innerHTML = '';
    const merged = [...addons].concat(JSON.parse(localStorage.getItem('addons_custom')||'[]'));
    merged.forEach((a,i)=>{
      const q = currentFilter;
      if(q){
        const hay = (a.name + ' ' + (a.description||'')).toLowerCase();
        if(!hay.includes(q)) return;
      }
      const div = document.createElement('div');
      div.className='card';
      div.innerHTML = `
        <img src="${a.image}" alt="${a.name}" loading="lazy" />
        <h3>${a.name}</h3>
        <p>${a.description||''}</p>
        <div class="cta">
          <button class="btn" onclick="openPopup(${i})">Chi ti·∫øt</button>
          <a class="btn secondary" href="${a.download||'#'}" target="_blank">‚¨áÔ∏è T·∫£i</a>
        </div>
        <div class="rating" id="rating_card_${i}"></div>
      `;
      container.appendChild(div);
      renderRatingStars(document.getElementById('rating_card_'+i), i, true);
    });
  }

  async function loadAddons(){
    try{
      const res = await fetch('addons.json',{cache:'no-cache'});
      const data = await res.json();
      addons = data;
    }catch(e){
      console.warn('Kh√¥ng th·ªÉ load addons.json ‚Äî d√πng local n·∫øu c√≥',e);
      addons = [];
    }
    renderAddons();
  }

  function openPopup(index){
    currentPopupIndex = index;
    const merged = [...addons].concat(JSON.parse(localStorage.getItem('addons_custom')||'[]'));
    const a = merged[index];
    if(!a) return;
    document.getElementById('popupImg').src = a.image;
    document.getElementById('popupName').innerText = a.name;
    document.getElementById('popupDesc').innerText = a.description || '';
    document.getElementById('popupLink').href = a.download || '#';
    document.getElementById('popup').style.display = 'flex';
    renderPopupRating(index);
    loadCommentsFor(index);
    document.querySelector('.comment-list').scrollTop = 0;
  }
  function closePopup(){ document.getElementById('popup').style.display='none'; currentPopupIndex=null; }

  function getCommentsKey(index){ return 'comments_addon_'+index; }
  function loadCommentsFor(index){
    const key = getCommentsKey(index);
    const list = JSON.parse(localStorage.getItem(key)||'[]');
    const container = document.getElementById('commentList');
    container.innerHTML = '';
    if(list.length===0){ container.innerHTML = '<div style="color:rgba(200,200,255,0.6)">Ch∆∞a c√≥ b√¨nh lu·∫≠n n√†o</div>'; return;}
    list.forEach(c=>{
      const el = document.createElement('div'); el.className='comment';
      el.innerHTML = `<div class="meta">${escapeHtml(c.name||'Ng∆∞·ªùi d√πng')} ‚Ä¢ ${new Date(c.t).toLocaleString()}</div><div class="body">${escapeHtml(c.text)}</div>`;
      container.appendChild(el);
    });
  }
  function addComment(){
    if(currentPopupIndex===null) return;
    const name = document.getElementById('commentName').value.trim() || 'Ng∆∞·ªùi d√πng';
    const text = document.getElementById('commentText').value.trim();
    if(!text){ alert('Vui l√≤ng nh·∫≠p n·ªôi dung b√¨nh lu·∫≠n'); return;}
    const key = getCommentsKey(currentPopupIndex);
    const arr = JSON.parse(localStorage.getItem(key)||'[]');
    arr.unshift({name,text,t:Date.now()});
    localStorage.setItem(key, JSON.stringify(arr));
    document.getElementById('commentText').value = '';
    loadCommentsFor(currentPopupIndex);
  }

  function escapeHtml(s){ return String(s).replace(/[&<>"'`]/g, function(m){ return {'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;',"`":'&#96;'}[m]; }); }

  // initial load
  window.addEventListener('load', ()=>{
    setTimeout(()=>{ document.getElementById('intro').style.display='none'; }, 2200);
    loadAddons();
    applyTheme('violet');
  });

  document.getElementById('popup').addEventListener('click', (e)=>{
    if(e.target.id==='popup') closePopup();
  });

  document.addEventListener('keydown', (e)=>{
    if(e.key==='Escape'){
      const sb = document.getElementById('sidebar');
      if(sb.classList.contains('active')) sb.classList.remove('active');
      const p = document.getElementById('popup');
      if(p.style.display==='flex') closePopup();
    }
  });

</script>
</body>
</html>
